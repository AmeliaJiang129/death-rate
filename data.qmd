# Data

## Technical description

### Data Source 1: GHE: Life tables

This dataset is collected and published by the World Health Organization. WHO collects time series of death registration data from as early as the 1950s for around 100 countries. This specific table publishes [annual period life tables for years 2000-2019](https://www.who.int/data/gho/data/indicators/indicator-details/GHO/gho-ghe-life-tables-by-who-region-global-health-estimates).

The dataset can be downloaded as .cvs file and excel file. We chose the .cvs format for easier importing. It has 9310 rows and 34 columns. Among all Indicators in column 2, we are only interested in life expectancy and death rate, so we will only keep rows of these two indicators (ex - expectation of life at age x and nMx: age-specific death rate between ages x and x+n) and drop others. Looking at the columns, there are many duplicated items, such as value and the corresponding value code, and some redundant items such as variable type. Hence, we will only keep the following informative columns: Indicator, Location, Period (year), Dim1 (sex), Dim2 (age group), FactValueNumeric for analysis purpose. After the data cleaning, our dataset has 2660 rows and 6 rows. 

Indicator contains two values: ex - expectation of life at age x and nMx: age-specific death rate between ages x and x+n, which are the indicators we are interested in analyzing. Location contains Global, Africa, Americans, Eastern Mediterranean, Europe, South-East Asia, and Western Pacific. Period stores year of the observation. Dim1 is sex, which contains Male and Female. Dim2 represent age groups, which has value from \<1 year to 85+ years, with the interval of 5. FactValueNumeric is the value for indicators, which is in numeric format.

### Data Source 2: GHE: Leading causes of death

WHO's Global Health Estimates (GHE) provide the latest available data on [causes of death](https://www.who.int/data/gho/data/themes/mortality-and-global-health-estimates/ghe-leading-causes-of-death) globally, by region and country, and by age, sex and income group. They provide key insights on mortality and morbidity trends to support informed decision-making on health policy and resource allocation.

These estimates are produced using data from multiple sources, including national vital registration data, latest estimates from WHO technical programmes, United Nations partners and inter-agency groups, as well as the Global Burden of Disease and other scientific studies. Before publishing, the GHE are reviewed by WHO Member States through consultation with national focal points and WHO country and regional offices.

The update intervals of this database are not strictly uniform. The specific time panels it includes are: 2000, 2010, 2015, and 2019. It can be exported directly in xlsx format from the website. The main feature columns include: Age Group, Sex Group, Time, Region, and Cause Category. This table records the number of deaths attributed to various causes. It consists of 4 (# of time period) $\times$ 6 (# of regions) sheets, each containing a 215-row (# of causes) $\times$ 16-column (# of gender-age subgroups) dataset table.

This dataset is an aggregate table of death counts, meaning that the recorded data is aggregated across different categorical dimensions rather than representing the raw records of individual deaths. This indicates that there is no single variable in this table, or in other words, the only numeric variable is the death count; all others are categorical variables. This implies that it will assist us in grouping data by different categories, facilitating the exploration of a comprehensible and insightful analysis of global health disparities, and allowing for targeted interventions in key areas.

Please note that the divisions of age, time, gender and region, which are categorical variables with the same meanings, are consistent across both data tables. This ensures that we can obtain research outcomes based on a uniform standard.

## **Research plan**

### Data Source 1:

***How has the death rate and life expectancy changed over time, globally and regionally?***

-   For the global overall trend, we will aggregate the data for each year and make a bar chart showing the death rate and life expectancy at birth from 2000 to 2019.

***Does death rate and life expectancy differ by sex?***

-   We will aggregate the data for each year by sex and make a side-by-side barchart to compare indicators for male and female, exploring whether there is a gap and whether the gap changes over time.

***Do more developed regions have lower death rate, higher life expectancy and larger changes than undeveloped regions?***

-   We will aggregate the data for each region and make side-by-side bar charts to compare each region.

***Do more developed regions have a more left skewed distribution of death rate on age?***

-   First we aggregate the data for each region, and make a histogram of death rate on age groups. 

### Data Source 2: GHE: Leading causes of death

-   ***What causes death globally and regionally?***

-   ***Does the composition of causes of death change over time?***

-   ***Are there any interaction effects between variables such as age and sex affect the causes of death?***

-   ***How do the causes of death differ and appear to be similar across regions, and is this associated with development level?***

Our research plan involves the following steps:

#### a. Data Aggregation and Preprocessing

-   Collect and preprocess the most recent data from the WHO's GHE database, ensuring data quality and consistency.

#### b. **Exploratory Data Analysis (EDA)**

-   Conduct a thorough EDA to visualize and summarize the distribution of causes of death globally.

-   Identify outliers, missing values, and any notable trends in the dataset.

#### **c. Temporal Analysis**

-   Examine temporal trends in causes of death over the past decade and identify regions or demographic groups experiencing significant changes in mortality rates.

-   Methods to be implemented: stacked bar chart for different categories, Cleveland dot plot.

#### d. **Regional Disparities**

-   Analyze causes of death by continent, emphasizing descriptive statistics to highlight regional variations. Explore the influence of socio-economic factors on mortality rates.

-   Methods to be implemented: PCA analysis with biplot, faceted geographic graphs.

#### e. **Age and Gender Disparities**

-   Utilize EDA techniques to explore causes of death by age group and gender, emphasizing visualizations for clarity.

-   Highlight any discernible patterns or disparities in mortality rates.

-   Methods to be implemented: stacked bar chart

By employing EDA and simple statistical tests, this research aims to offer a comprehensible and insightful analysis of global health disparities. The findings from this study can inform targeted public health strategies and contribute to ongoing efforts to improve health outcomes on a global scale.

## Missing values analysis

```{r}
library(readxl)
library(tidyr)
library(dplyr)
library(ggplot2)
```

### Data Source 1:

```{r}
data <- read.csv('dataset1.csv')

#Dimension
print("Dimension of data")
print(dim(data))

#Check Missing Value
missing <- colSums(is.na(data))
missing_df <- data.frame(
  Column = names(missing),
  Missing_Values = missing
)
missing_df
```

Looking at the raw data, we can see that columns associated with Dim3, DataSourceDimValueCode, DataSource, FactValueNumericPrefix, FactValueUoM, FactValueNumericLowPrefix, FactValueNumericLow, FactValueNumericHighPrefix, FactValueNumericHigh are completely missing. This is because we only have two dimension categorical variables: sex and age group, and FactValueNumeric bears sufficient information for the indicator value. Therefore, we will remove those completely missing columns and one of the duplicated columns such as value/ValueCode and location/LocationCode.

|     |
|:----|
|     |

```{r}
# Data Cleaning
data <- data[data$Indicator %in% c('nMx - age-specific death rate between ages x and x+n','ex - expectation of life at age x'), ]
data <- data[ , c('Indicator', 'Location', 'Period', 'Dim1', 'Dim2', 'FactValueNumeric')]

# Dimension
print("Dimension of data")
print(dim(data))

# Check missing values
missing_values <- sum(is.na(data))
print(paste("Number of missing values: ", missing_values))
```

After data cleaning, there is no missing value in this dataset, and we can further show this in an pie chart.

```{r}
# Plot to show 
missing_dummy <- as.numeric(!is.na(data))

# Calculate the percentage of present and missing values
present_perc <- sum(missing_dummy) / length(missing_dummy) * 100
missing_perc <- 100 - present_perc

# Create a pie chart
pie_data <- c(present_perc, missing_perc)
pie_labels <- c("Present", "Missing")
label_perc <- sprintf("%1.1f%%", pie_data)
labels_combined <- paste(pie_labels, "\n", label_perc)

# Create a pie chart with labels
pie(pie_data, labels = labels_combined,
    col = c("#00AFBB", "#E7B800"),
    main = "Data Completeness",
    cex.main = 0.8)
```

### Data Source 2: GHE: Leading causes of death

由于

```{r}
df2 <- read_excel("ghecode2019.xlsx", sheet = "Summary",col_names = TRUE)

df_long <- pivot_longer(df2,cols = Global:WPR, names_to = "region", values_to = "death_num")

filtered_data <- df_long %>%
  filter(region != "Global")

filtered_data <- filtered_data %>%
  mutate(if_zero = ifelse(death_num == 0, 'zero', 'non-zero'))

ggplot(filtered_data, aes(x = if_zero)) +
  geom_bar(stat = "count") +
  labs(
    title = "Zero and Non-Zero Proportions on Different Levels of Death Cause Category",
    x = "If Zero",
    y = "Count"
  )+
  facet_wrap(~level,scales = "free_y")
```

```{r}
file_path <- "ghecode2019_1.xlsx"
df_2019 <- data.frame()
for (sheet_name in excel_sheets(file_path)) {
  current_sheet <- read_excel(file_path, sheet = sheet_name)
  df_2019 <- bind_rows(df_2019, current_sheet)
}

check if is na,两种可能，一种真的没有，一种是missing，先assume真的没有
```

\
